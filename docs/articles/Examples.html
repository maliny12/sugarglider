<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples • sugarglider</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sugarglider</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/sugarglider.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/Examples.html">Examples</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change Log</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maliny12/sugarglider/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="Examples_files/kePrint-0.0.1/kePrint.js"></script><link href="Examples_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maliny12/sugarglider/blob/HEAD/vignettes/Examples.Rmd" class="external-link"><code>vignettes/Examples.Rmd</code></a></small>
      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="monthly-temperature-across-australia">Monthly temperature across Australia<a class="anchor" aria-label="anchor" href="#monthly-temperature-across-australia"></a>
</h3>
<p>The National Oceanic and Atmospheric Administration (NOAA) provides
comprehensive weather data from numerous stations across Australia. The
<code>aus_temp</code> dataset includes key climate variables, such as
precipitation and temperature, recorded at 29 different weather stations
throughout 2020.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">aus_temp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kable_styling</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
long
</th>
<th style="text-align:right;">
lat
</th>
<th style="text-align:right;">
month
</th>
<th style="text-align:right;">
tmin
</th>
<th style="text-align:right;">
tmax
</th>
<th style="text-align:right;">
prcp
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
253.4516
</td>
<td style="text-align:right;">
319.0000
</td>
<td style="text-align:right;">
163.87097
</td>
</tr>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
248.6786
</td>
<td style="text-align:right;">
322.6071
</td>
<td style="text-align:right;">
162.74074
</td>
</tr>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
253.6129
</td>
<td style="text-align:right;">
333.1935
</td>
<td style="text-align:right;">
42.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
244.0357
</td>
<td style="text-align:right;">
340.9310
</td>
<td style="text-align:right;">
21.57143
</td>
</tr>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
220.4138
</td>
<td style="text-align:right;">
331.9333
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
ASN00001020
</td>
<td style="text-align:right;">
126.3867
</td>
<td style="text-align:right;">
-14.09
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
202.3667
</td>
<td style="text-align:right;">
310.9000
</td>
<td style="text-align:right;">
11.20000
</td>
</tr>
</tbody>
</table>
<p>Using the default rescaling parameters, we can visualize the
temperature data through <code><a href="../reference/geom_glyph_segment.html">geom_glyph_segment()</a></code>, alongside
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> elements that mark the location of each
weather station. Each segment glyph represents local climate data,
offering an intuitive way to explore temperature variations across
Australia.</p>
<p>The default <code>identity</code> scaling function is applied to each
set of minor values within a grid cell. This method centers the glyphs
both vertically and horizontally based on the station’s coordinates and
adjusts the minor axes to fit within the interval [-1, 1]. This ensures
that the glyphs are appropriately sized to fit the desired dimensions.
In this example, we will also be specifying the size of the glyph by
specifying the size of the width and height of the glyph.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aus_temp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x_major <span class="op">=</span> <span class="va">long</span>, </span>
<span>    y_major <span class="op">=</span> <span class="va">lat</span>, </span>
<span>    x_minor <span class="op">=</span> <span class="va">month</span>, </span>
<span>    y_minor <span class="op">=</span> <span class="va">tmin</span>, </span>
<span>    yend_minor <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>,<span class="fl">155</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add glyph box to each glyph</span></span>
<span>  <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span> width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add points for weather station </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"Weather Station"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Customize the size of each glyph box using the width and height parameters.</span></span>
<span>  <span class="fu"><a href="../reference/geom_glyph_segment.html">geom_glyph_segment</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theme and aesthetic </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weather Station"</span> <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>               <span class="st">"Temperature"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Data"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Daily Temperature Variations Across Australian Weather Stations"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-3-1.png" width="960"></p>
<pre><code><span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##     yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span></code></pre>
<p>So far, all the visualizations have used global rescaling (enabled by
default), meaning the glyphs are sized relative to one another based on
their data values. By disabling global rescaling, we can see the effects
of local rescaling, where each glyph is resized based on its individual
values.</p>
<ul>
<li>
<strong>Local Rescale (global_rescale = FALSE)</strong>: Each line
segment’s length is determined by the local temperature range within a
region, emphasizing regional differences in temperature patterns.</li>
<li>
<strong>Global Rescale (global_rescale = TRUE)</strong>: Global
temperature range determined the length of each line segment, ensuring
that data range remain consistent across all region for easy
comparison.</li>
</ul>
<p>Below is a comparison of the two rescaling approaches. In this
example, we also specify the size of the glyphs by setting width = 3 and
height = 2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Global rescale</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">aus_temp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x_major <span class="op">=</span> <span class="va">long</span>, </span>
<span>    y_major <span class="op">=</span> <span class="va">lat</span>, </span>
<span>    x_minor <span class="op">=</span> <span class="va">month</span>, </span>
<span>    y_minor <span class="op">=</span> <span class="va">tmin</span>, </span>
<span>    yend_minor <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>,<span class="fl">155</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add glyph box to each glyph</span></span>
<span>  <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add reference lines to each glyph</span></span>
<span>  <span class="fu"><a href="../reference/add_ref_lines.html">add_ref_lines</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Glyph segment plot with global rescale</span></span>
<span>  <span class="fu"><a href="../reference/geom_glyph_segment.html">geom_glyph_segment</a></span><span class="op">(</span>global_rescale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Global Rescale"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Local Rescale</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">aus_temp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x_major <span class="op">=</span> <span class="va">long</span>, </span>
<span>    y_major <span class="op">=</span> <span class="va">lat</span>, </span>
<span>    x_minor <span class="op">=</span> <span class="va">month</span>, </span>
<span>    y_minor <span class="op">=</span> <span class="va">tmin</span>, </span>
<span>    yend_minor <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>,<span class="fl">155</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add glyph box to each glyph</span></span>
<span>  <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add reference lines to each glyph</span></span>
<span>  <span class="fu"><a href="../reference/add_ref_lines.html">add_ref_lines</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Glyph segment plot with local rescale</span></span>
<span>  <span class="fu"><a href="../reference/geom_glyph_segment.html">geom_glyph_segment</a></span><span class="op">(</span>global_rescale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     width <span class="op">=</span> <span class="fl">3</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Local Rescale"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<pre><code><span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##     yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, segment = TRUE)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">## debug: data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##     yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, yend_minor)[[1]], </span></span>
<span><span class="co">##     yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$yend_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span></code></pre>
<div class="section level4">
<h4 id="highlighting-temperature-changes-with-color-coded-glyph">Highlighting Temperature Changes with Color-Coded Glyph<a class="anchor" aria-label="anchor" href="#highlighting-temperature-changes-with-color-coded-glyph"></a>
</h4>
<p>Expanding on our temperature analysis, we now incorporate
precipitation data across Australia using
<code><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon()</a></code>. The glyphs are color-coded to
represent varying levels of rainfall, with reference lines and glyph
boxes enhancing clarity and allow for easy comparison of precipitation
level across the country.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prcp</span> <span class="op">&lt;-</span> <span class="va">aus_temp</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu">mutate</span><span class="op">(</span>prcp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prcp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x_major <span class="op">=</span> <span class="va">long</span>, y_major <span class="op">=</span> <span class="va">lat</span>,</span>
<span>              x_minor <span class="op">=</span> <span class="va">month</span>, ymin_minor <span class="op">=</span> <span class="va">tmin</span>,</span>
<span>              ymax_minor <span class="op">=</span> <span class="va">tmax</span>, </span>
<span>              fill <span class="op">=</span> <span class="va">prcp</span>, color <span class="op">=</span> <span class="va">prcp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add glyph box to each glyph</span></span>
<span>   <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add ref line to each glyph</span></span>
<span>   <span class="fu"><a href="../reference/add_ref_lines.html">add_ref_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add glyph ribbon plots</span></span>
<span>   <span class="fu"><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">112</span>,<span class="fl">155</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theme and aesthetic </span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ADD8E6"</span>, <span class="st">"#2b5e82"</span>, <span class="st">"dodgerblue4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"#ADD8E6"</span>, <span class="st">"#2b5e82"</span>, <span class="st">"dodgerblue4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Percepitation"</span>, color <span class="op">=</span> <span class="st">"Percepitation"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Precipitation and Temperature Ranges Across Australia"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">prcp</span></span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<pre><code><span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##     ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span></code></pre>
<p>If you’re interested in comparing temperature trends across different
years for specific regions in Victoria, <code><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon()</a></code>
provides a way to visualize how temperatures have evolved over time,
with each year distinguished by a different color for clarity.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fact</span> <span class="op">&lt;-</span> <span class="va">historical_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASN00026021"</span>, <span class="st">"ASN00085291"</span>, <span class="st">"ASN00084143"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>              group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">id</span><span class="op">)</span>,</span>
<span>              x_major <span class="op">=</span> <span class="va">long</span>, y_major <span class="op">=</span> <span class="va">lat</span>,</span>
<span>              x_minor <span class="op">=</span> <span class="va">month</span>, ymin_minor <span class="op">=</span> <span class="va">tmin</span>, </span>
<span>              ymax_minor <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NAME</span> <span class="op">==</span> <span class="st">"Victoria"</span><span class="op">)</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"antiquewhite"</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># Customized the dimension of each glyph with `width` and `height` parameters</span></span>
<span>   <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                   height <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="../reference/add_ref_lines.html">add_ref_lines</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                 height <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                     width <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                     height <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"year"</span>, fill <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Temperature Trends in Selected Victorian Weather Stations"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theme and aesthetic</span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_wsj</span><span class="op">(</span><span class="st">"colors6"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_wsj</span><span class="op">(</span><span class="st">"colors6"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">fact</span></span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<pre><code><span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##     ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="integrating-glyph-legends">Integrating Glyph Legends<a class="anchor" aria-label="anchor" href="#integrating-glyph-legends"></a>
</h4>
<p>To further enhance map readability, the
<code>add_geom_legend()</code> function integrates a larger version of
one of the glyphs into the bottom left corner of the plot. This legend
helps users interpret the scale of the data.</p>
<p>In the example below, a series of glyph are created using
<code><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon()</a></code> and overlaid on a base map to depict
daily temperature variations across Australian weather stations. A
legend is added through <code><a href="../reference/add_glyph_legend.html">add_glyph_legend()</a></code>, allowing users
to easily interpret the range of daily temperature value based on a
randomly selected weather station. Since the legend data is drawn from a
single, randomly chosen station, it’s important for users to set a seed
for reproducibility to ensure consistent results.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">28493</span><span class="op">)</span></span>
<span><span class="va">legend</span> <span class="op">&lt;-</span> <span class="va">aus_temp</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x_major <span class="op">=</span> <span class="va">long</span>, y_major <span class="op">=</span> <span class="va">lat</span>,</span>
<span>              x_minor <span class="op">=</span> <span class="va">month</span>, ymin_minor <span class="op">=</span> <span class="va">tmin</span>,</span>
<span>              ymax_minor <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_ste</span>, fill <span class="op">=</span> <span class="st">"antiquewhite"</span>,</span>
<span>          inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/add_glyph_boxes.html">add_glyph_boxes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#227B94"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/add_ref_lines.html">add_ref_lines</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#227B94"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/add_glyph_legend.html">add_glyph_legend</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#227B94"</span>, fill <span class="op">=</span> <span class="st">"#227B94"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a ribbon legend</span></span>
<span>  <span class="fu"><a href="../reference/geom_glyph_ribbon.html">geom_glyph_ribbon</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#227B94"</span>, fill <span class="op">=</span> <span class="st">"#227B94"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_glyph.html">theme_glyph</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Temperature Ranges Across Australia with Glyph Legend"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">legend</span></span></code></pre></div>
<p><img src="Examples_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
<pre><code><span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params, ...)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##     ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##     .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span>
<span><span class="co">## Called from: glyph_setup_data(data, params)</span></span>
<span><span class="co">## debug: if (!inherits(data$x_minor, c("Date", "yearmonth", "numeric", </span></span>
<span><span class="co">##     "factor", "yearweek", "yearquarter", "yearqtr", "POSIXct", </span></span>
<span><span class="co">##     "POSIXlt"))) {</span></span>
<span><span class="co">##     stop("Error: Unsupported class for x_minor. Supported classes are Date,\n         yearmonth, numeric, factor, yearweek, yearquarter, yearqtr, POSIXct, and POSIXlt.")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (dplyr::n_distinct(data$group) == 1 || (inherits(data$x_minor, </span></span>
<span><span class="co">##     "factor") &amp;&amp; !any(c("colour", "color", "fill") %in% names(data)))) {</span></span>
<span><span class="co">##     data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">##     data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$group &lt;- as.integer(factor(paste(data$x_major, data$y_major)))</span></span>
<span><span class="co">## debug: data &lt;- dplyr::group_by(data, .data$group)</span></span>
<span><span class="co">## debug: if (!is.numeric(data$x_minor)) {</span></span>
<span><span class="co">##     data[["x_minor"]] &lt;- as.numeric(data[["x_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data[["y_minor"]] &lt;- as.numeric(data[["y_minor"]])</span></span>
<span><span class="co">##     data[["yend_minor"]] &lt;- as.numeric(data[["yend_minor"]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">##     data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data[["ymin_minor"]] &lt;- as.numeric(data[["ymin_minor"]])</span></span>
<span><span class="co">## debug: data[["ymax_minor"]] &lt;- as.numeric(data[["ymax_minor"]])</span></span>
<span><span class="co">## debug: if (any(is.na(data))) {</span></span>
<span><span class="co">##     warning(paste("Removed rows containing missing values"))</span></span>
<span><span class="co">##     data &lt;- na.omit(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (custom_scale(params$x_scale)) {</span></span>
<span><span class="co">##     x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: x_scale &lt;- get_scale(params$x_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x_minor = x_scale(.data$x_minor))</span></span>
<span><span class="co">## debug: if (custom_scale(params$y_scale)) {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##             yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##             ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = y_scale(.data$y_minor), </span></span>
<span><span class="co">##         yend_minor = y_scale(.data$yend_minor))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##         ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: y_scale &lt;- get_scale(params$y_scale)</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, ymin_minor = y_scale(.data$ymin_minor), </span></span>
<span><span class="co">##     ymax_minor = y_scale(.data$ymax_minor))</span></span>
<span><span class="co">## debug: if (isTRUE(params$global_rescale)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::ungroup(data)</span></span>
<span><span class="co">## debug: if (isTRUE(arg$legend)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::select(dplyr::filter(dplyr::mutate(data, com = interaction(.data$x_major, </span></span>
<span><span class="co">##         .data$y_major)), com == sample(com, 1)), -com)</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[1]], yend_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##             yend_minor)[[2]])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##             cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##             values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##             -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$yend_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else {</span></span>
<span><span class="co">##         data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##             rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##             .data$ymax_minor, params$height))</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, y_minor = rescale11y(y_minor, </span></span>
<span><span class="co">##         yend_minor)[[1]], yend_minor = rescale11y(y_minor, yend_minor)[[2]])</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##         cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##         values_to = "value"), scaled_data = rescale(value)), </span></span>
<span><span class="co">##         -value), names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- tidyr::pivot_wider(dplyr::select(dplyr::mutate(tidyr::pivot_longer(data, </span></span>
<span><span class="co">##     cols = c("ymin_minor", "ymax_minor"), names_to = "type", </span></span>
<span><span class="co">##     values_to = "value"), scaled_data = rescale(value)), -value), </span></span>
<span><span class="co">##     names_from = "type", values_from = "scaled_data")</span></span>
<span><span class="co">## debug: if (isTRUE(arg$segment)) {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), xend = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), y = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$y_minor, params$height), yend = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$yend_minor, params$height))</span></span>
<span><span class="co">## } else {</span></span>
<span><span class="co">##     data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##         rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##         .data$ymax_minor, params$height))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data &lt;- dplyr::mutate(data, x = glyph_mapping(.data$x_major, </span></span>
<span><span class="co">##     rescale(.data$x_minor), params$width), ymin = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymin_minor, params$height), ymax = glyph_mapping(.data$y_major, </span></span>
<span><span class="co">##     .data$ymax_minor, params$height))</span></span>
<span><span class="co">## debug: if (!("linewidth" %in% colnames(data))) {</span></span>
<span><span class="co">##     data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## debug: data$linewidth &lt;- 0.5</span></span>
<span><span class="co">## debug: dplyr::ungroup(data)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="observations-and-insights">Observations and Insights<a class="anchor" aria-label="anchor" href="#observations-and-insights"></a>
</h4>
<p>Both the Geom Glyph Segment and Geom Glyph Ribbon provide valuable
insights into seasonal temperature trends across Australia. Disabling
global rescaling reveals that most weather stations follow similar
curvature trends relative to their neighboring stations. However, with
global rescaling enabled, it becomes apparent that coastal regions
exhibit far less temperature variation overall.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maliny Po, S. Nathan Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
